import csv
from bing import geocoord_patient_dict
from brute_force import geocoord_clinic_dict


# final_list = [testperson,
#               testperson2]





#geocord_patient_dict = [{'id': '1', 'geo_cols': '722 85 ST SW CALGARY Canada', 'geo_code': (51.0665226, -114.2094385), 'address': '722 85 ST SW', 'postal_code': 'T3H 1S6', 'fsa': 'T3H', 'nearest_clinic_id': '', 'distance': '', 'city': 'CALGARY', 'provence': 'AB', 'candidates': [{'id': '1', 'geo_cols': '8308 114 ST NW Edmonton Canada', 'geo_code': (53.5165968, -113.5258937), 'address': '8308 114 ST NW', 'postal_code': 'T6G 2V2', 'fsa': 'T6G', 'nearest_clinic_id': '', 'distance': 2711.092089822715, 'city': 'Edmonton', 'provence': 'AB', 'bing_results': {'travel_distance': 314.034, 'travel_time': 11006.0}, 'closest': False}, {'id': '3', 'geo_cols': '4715 8 Ave Se Calgary Canada', 'geo_code': (51.044899900000004, -113.9672190999108), 'address': '4715 8 Ave Se', 'postal_code': 'T2A 3N4', 'fsa': 'T2A', 'nearest_clinic_id': '', 'distance': 2708.4718471837928, 'city': 'Calgary', 'provence': 'AB', 'bing_results': {'travel_distance': 20.623, 'travel_time': 1806.0}, 'closest': False}, {'id': '7', 'geo_cols': '1441 29 St Nw Calgary Canada', 'geo_code': (51.0554551, -114.1295186), 'address': '1441 29 St Nw', 'postal_code': 'T2N 4J8', 'fsa': 'T2N', 'nearest_clinic_id': '', 'distance': 2719.869668126654, 'city': 'Calgary', 'provence': 'AB', 'bing_results': {'travel_distance': 11.464, 'travel_time': 1080.0}, 'closest': True}, {'id': '13', 'geo_cols': '3713 Kensington Ave Burnaby Canada', 'geo_code': (49.2513009, -122.9674826), 'address': '3713 Kensington Ave', 'postal_code': 'V5B 0A7', 'fsa': 'V5B', 'nearest_clinic_id': '', 'distance': 3353.808672958544, 'city': 'Burnaby', 'provence': 'BC', 'bing_results': {'travel_distance': 948.214, 'travel_time': 34863.0}, 'closest': False}, {'id': '14', 'geo_cols': '409 TACHE AVE Winnipeg Canada', 'geo_code': (49.8833047, -97.1246203), 'address': '409 TACHE AVE', 'postal_code': 'R2H 2A6', 'fsa': 'R2H', 'nearest_clinic_id': '', 'distance': 1517.666032871934, 'city': 'Winnipeg', 'provence': 'MB', 'bing_results': {'travel_distance': 1357.53, 'travel_time': 47011.0}, 'closest': False}]}, {'id': '2', 'geo_cols': '1640 BLOOR ST W TORONTO Canada', 'geo_code': (43.6556336, -79.4564275), 'address': '1640 BLOOR ST W', 'postal_code': 'M6P 1A7', 'fsa': 'M6P', 'nearest_clinic_id': '', 'distance': '', 'city': 'TORONTO', 'provence': 'ON', 'candidates': [{'id': '2', 'geo_cols': '3480 LAWRENCE AVE E Scarborough Canada', 'geo_code': (43.75979288235294, -79.22662067058823), 'address': '3480 LAWRENCE AVE E', 'postal_code': 'M1H 1A9', 'fsa': 'M1H', 'nearest_clinic_id': '', 'distance': 6.71751140513781, 'city': 'Scarborough', 'provence': 'ON', 'bing_results': {'travel_distance': 7.619, 'travel_time': 985.0}, 'closest': True}, {'id': '4', 'geo_cols': '234 Dovedale Drive Keswick Canada', 'geo_code': (44.2171594, -79.4635385), 'address': '234 Dovedale Drive', 'postal_code': 'L4P 0H3', 'fsa': 'L4P', 'nearest_clinic_id': '', 'distance': 58.75517109101242, 'city': 'Keswick', 'provence': 'ON', 'bing_results': {'travel_distance': 66.095, 'travel_time': 3112.0}, 'closest': False}, {'id': '8', 'geo_cols': '910 Rue Labelle Saint-Jerome Canada', 'geo_code': (45.788776, -74.0058915), 'address': '910 Rue Labelle', 'postal_code': 'J7Z 5M5', 'fsa': 'J7Z', 'nearest_clinic_id': '', 'distance': 475.56395543076275, 'city': 'Saint-Jerome', 'provence': 'QC', 'bing_results': {'travel_distance': 557.648, 'travel_time': 21833.0}, 'closest': False}, {'id': '10', 'geo_cols': '1615 BOUL JACQUES-CARTIER E Longueuil Canada', 'geo_code': (43.65365176827117, -79.3942239178996), 'address': '1615 BOUL JACQUES-CARTIER E', 'postal_code': 'J4M 2X1', 'fsa': 'J4M', 'nearest_clinic_id': '', 'distance': 11.73261723162927, 'city': 'Longueuil', 'provence': 'QC', 'warning': 'did not find the geocode', 'bing_results': {'travel_distance': 16.759, 'travel_time': 1724.0}, 'closest': False}, {'id': '12', 'geo_cols': '345 Rumsey Rd Toronto Canada', 'geo_code': (43.718796350000005, -79.37166616722675), 'address': '345 Rumsey Rd', 'postal_code': 'M4G 1R7', 'fsa': 'M4G', 'nearest_clinic_id': '', 'distance': 8.351816720090264, 'city': 'Toronto', 'provence': 'ON', 'bing_results': {'travel_distance': 12.197, 'travel_time': 1530.0}, 'closest': False}]}, {'id': '3', 'geo_cols': '284 HELMCKEN RD VICTORIA Canada', 'geo_code': (43.65365176827117, -79.3942239178996), 'address': '284 HELMCKEN RD', 'postal_code': 'V9B 1T2', 'fsa': 'V9B', 'nearest_clinic_id': '', 'distance': '', 'city': 'VICTORIA', 'provence': 'BC', 'warning': 'did not find the geocode', 'candidates': [{'id': '2', 'geo_cols': '3480 LAWRENCE AVE E Scarborough Canada', 'geo_code': (43.75979288235294, -79.22662067058823), 'address': '3480 LAWRENCE AVE E', 'postal_code': 'M1H 1A9', 'fsa': 'M1H', 'nearest_clinic_id': '', 'distance': 6.71751140513781, 'city': 'Scarborough', 'provence': 'ON', 'bing_results': {'travel_distance': 7.619, 'travel_time': 985.0}, 'closest': True}, {'id': '4', 'geo_cols': '234 Dovedale Drive Keswick Canada', 'geo_code': (44.2171594, -79.4635385), 'address': '234 Dovedale Drive', 'postal_code': 'L4P 0H3', 'fsa': 'L4P', 'nearest_clinic_id': '', 'distance': 58.75517109101242, 'city': 'Keswick', 'provence': 'ON', 'bing_results': {'travel_distance': 66.095, 'travel_time': 3112.0}, 'closest': False}, {'id': '8', 'geo_cols': '910 Rue Labelle Saint-Jerome Canada', 'geo_code': (45.788776, -74.0058915), 'address': '910 Rue Labelle', 'postal_code': 'J7Z 5M5', 'fsa': 'J7Z', 'nearest_clinic_id': '', 'distance': 475.56395543076275, 'city': 'Saint-Jerome', 'provence': 'QC', 'bing_results': {'travel_distance': 557.648, 'travel_time': 21833.0}, 'closest': False}, {'id': '10', 'geo_cols': '1615 BOUL JACQUES-CARTIER E Longueuil Canada', 'geo_code': (43.65365176827117, -79.3942239178996), 'address': '1615 BOUL JACQUES-CARTIER E', 'postal_code': 'J4M 2X1', 'fsa': 'J4M', 'nearest_clinic_id': '', 'distance': 11.73261723162927, 'city': 'Longueuil', 'provence': 'QC', 'warning': 'did not find the geocode', 'bing_results': {'travel_distance': 16.759, 'travel_time': 1724.0}, 'closest': False}, {'id': '12', 'geo_cols': '345 Rumsey Rd Toronto Canada', 'geo_code': (43.718796350000005, -79.37166616722675), 'address': '345 Rumsey Rd', 'postal_code': 'M4G 1R7', 'fsa': 'M4G', 'nearest_clinic_id': '', 'distance': 8.351816720090264, 'city': 'Toronto', 'provence': 'ON', 'bing_results': {'travel_distance': 12.197, 'travel_time': 1530.0}, 'closest': False}]}, {'id': '4', 'geo_cols': '85 NORFOLK ST GUELPH Canada', 'geo_code': (43.5448594, -80.2513396), 'address': '85 NORFOLK ST', 'postal_code': 'N1H 4J4', 'fsa': 'N1H', 'nearest_clinic_id': '', 'distance': '', 'city': 'GUELPH', 'provence': 'ON', 'candidates': [{'id': '2', 'geo_cols': '3480 LAWRENCE AVE E Scarborough Canada', 'geo_code': (43.75979288235294, -79.22662067058823), 'address': '3480 LAWRENCE AVE E', 'postal_code': 'M1H 1A9', 'fsa': 'M1H', 'nearest_clinic_id': '', 'distance': 6.71751140513781, 'city': 'Scarborough', 'provence': 'ON', 'bing_results': {'travel_distance': 7.619, 'travel_time': 985.0}, 'closest': True}, {'id': '4', 'geo_cols': '234 Dovedale Drive Keswick Canada', 'geo_code': (44.2171594, -79.4635385), 'address': '234 Dovedale Drive', 'postal_code': 'L4P 0H3', 'fsa': 'L4P', 'nearest_clinic_id': '', 'distance': 58.75517109101242, 'city': 'Keswick', 'provence': 'ON', 'bing_results': {'travel_distance': 66.095, 'travel_time': 3112.0}, 'closest': False}, {'id': '8', 'geo_cols': '910 Rue Labelle Saint-Jerome Canada', 'geo_code': (45.788776, -74.0058915), 'address': '910 Rue Labelle', 'postal_code': 'J7Z 5M5', 'fsa': 'J7Z', 'nearest_clinic_id': '', 'distance': 475.56395543076275, 'city': 'Saint-Jerome', 'provence': 'QC', 'bing_results': {'travel_distance': 557.648, 'travel_time': 21833.0}, 'closest': False}, {'id': '10', 'geo_cols': '1615 BOUL JACQUES-CARTIER E Longueuil Canada', 'geo_code': (43.65365176827117, -79.3942239178996), 'address': '1615 BOUL JACQUES-CARTIER E', 'postal_code': 'J4M 2X1', 'fsa': 'J4M', 'nearest_clinic_id': '', 'distance': 11.73261723162927, 'city': 'Longueuil', 'provence': 'QC', 'warning': 'did not find the geocode', 'bing_results': {'travel_distance': 16.759, 'travel_time': 1724.0}, 'closest': False}, {'id': '12', 'geo_cols': '345 Rumsey Rd Toronto Canada', 'geo_code': (43.718796350000005, -79.37166616722675), 'address': '345 Rumsey Rd', 'postal_code': 'M4G 1R7', 'fsa': 'M4G', 'nearest_clinic_id': '', 'distance': 8.351816720090264, 'city': 'Toronto', 'provence': 'ON', 'bing_results': {'travel_distance': 12.197, 'travel_time': 1530.0}, 'closest': False}]}, {'id': '5', 'geo_cols': '462 BIRCHMOUNT RD SCARBOROUGH Canada', 'geo_code': (43.7076736, -79.2688982), 'address': '462 BIRCHMOUNT RD', 'postal_code': 'M1K 1N8', 'fsa': 'M1K', 'nearest_clinic_id': '', 'distance': '', 'city': 'SCARBOROUGH', 'provence': 'ON', 'candidates': [{'id': '2', 'geo_cols': '3480 LAWRENCE AVE E Scarborough Canada', 'geo_code': (43.75979288235294, -79.22662067058823), 'address': '3480 LAWRENCE AVE E', 'postal_code': 'M1H 1A9', 'fsa': 'M1H', 'nearest_clinic_id': '', 'distance': 6.71751140513781, 'city': 'Scarborough', 'provence': 'ON', 'bing_results': {'travel_distance': 7.619, 'travel_time': 985.0}, 'closest': True}, {'id': '4', 'geo_cols': '234 Dovedale Drive Keswick Canada', 'geo_code': (44.2171594, -79.4635385), 'address': '234 Dovedale Drive', 'postal_code': 'L4P 0H3', 'fsa': 'L4P', 'nearest_clinic_id': '', 'distance': 58.75517109101242, 'city': 'Keswick', 'provence': 'ON', 'bing_results': {'travel_distance': 66.095, 'travel_time': 3112.0}, 'closest': False}, {'id': '8', 'geo_cols': '910 Rue Labelle Saint-Jerome Canada', 'geo_code': (45.788776, -74.0058915), 'address': '910 Rue Labelle', 'postal_code': 'J7Z 5M5', 'fsa': 'J7Z', 'nearest_clinic_id': '', 'distance': 475.56395543076275, 'city': 'Saint-Jerome', 'provence': 'QC', 'bing_results': {'travel_distance': 557.648, 'travel_time': 21833.0}, 'closest': False}, {'id': '10', 'geo_cols': '1615 BOUL JACQUES-CARTIER E Longueuil Canada', 'geo_code': (43.65365176827117, -79.3942239178996), 'address': '1615 BOUL JACQUES-CARTIER E', 'postal_code': 'J4M 2X1', 'fsa': 'J4M', 'nearest_clinic_id': '', 'distance': 11.73261723162927, 'city': 'Longueuil', 'provence': 'QC', 'warning': 'did not find the geocode', 'bing_results': {'travel_distance': 16.759, 'travel_time': 1724.0}, 'closest': False}, {'id': '12', 'geo_cols': '345 Rumsey Rd Toronto Canada', 'geo_code': (43.718796350000005, -79.37166616722675), 'address': '345 Rumsey Rd', 'postal_code': 'M4G 1R7', 'fsa': 'M4G', 'nearest_clinic_id': '', 'distance': 8.351816720090264, 'city': 'Toronto', 'provence': 'ON', 'bing_results': {'travel_distance': 12.197, 'travel_time': 1530.0}, 'closest': False}]}]
#geocoord_clinic_dict = [{'id': '1', 'geo_cols': '8308 114 ST NW Edmonton Canada', 'geo_code': (53.5165968, -113.5258937), 'address': '8308 114 ST NW', 'postal_code': 'T6G 2V2', 'fsa': 'T6G', 'nearest_clinic_id': '', 'distance': 2711.092089822715, 'city': 'Edmonton', 'provence': 'AB', 'bing_results': {'travel_distance': 314.034, 'travel_time': 11006.0}}, {'id': '2', 'geo_cols': '3480 LAWRENCE AVE E Scarborough Canada', 'geo_code': (43.75979288235294, -79.22662067058823), 'address': '3480 LAWRENCE AVE E', 'postal_code': 'M1H 1A9', 'fsa': 'M1H', 'nearest_clinic_id': '', 'distance': 6.71751140513781, 'city': 'Scarborough', 'provence': 'ON', 'bing_results': {'travel_distance': 7.619, 'travel_time': 985.0}, 'closest': True}, {'id': '3', 'geo_cols': '4715 8 Ave Se Calgary Canada', 'geo_code': (51.044899900000004, -113.9672190999108), 'address': '4715 8 Ave Se', 'postal_code': 'T2A 3N4', 'fsa': 'T2A', 'nearest_clinic_id': '', 'distance': 2708.4718471837928, 'city': 'Calgary', 'provence': 'AB', 'bing_results': {'travel_distance': 20.623, 'travel_time': 1806.0}}, {'id': '4', 'geo_cols': '234 Dovedale Drive Keswick Canada', 'geo_code': (44.2171594, -79.4635385), 'address': '234 Dovedale Drive', 'postal_code': 'L4P 0H3', 'fsa': 'L4P', 'nearest_clinic_id': '', 'distance': 58.75517109101242, 'city': 'Keswick', 'provence': 'ON', 'bing_results': {'travel_distance': 66.095, 'travel_time': 3112.0}}, {'id': '5', 'geo_cols': '3968 RUE NOTRE-DAME O Montreal Canada', 'geo_code': (45.4342995, -73.6940492), 'address': '3968 RUE NOTRE-DAME O', 'postal_code': 'H4C 1R1', 'fsa': 'H4C', 'nearest_clinic_id': '', 'distance': 481.39392087426154, 'city': 'Montreal', 'provence': 'QC'}, {'id': '6', 'geo_cols': '3400 RUE DU MARCHE Dollard-Des-Ormeaux Canada', 'geo_code': (45.4864572, -73.8013395), 'address': '3400 RUE DU MARCHE', 'postal_code': 'H9B 2Y1', 'fsa': 'H9B', 'nearest_clinic_id': '', 'distance': 475.8182206442619, 'city': 'Dollard-Des-Ormeaux', 'provence': 'QC'}, {'id': '7', 'geo_cols': '1441 29 St Nw Calgary Canada', 'geo_code': (51.0554551, -114.1295186), 'address': '1441 29 St Nw', 'postal_code': 'T2N 4J8', 'fsa': 'T2N', 'nearest_clinic_id': '', 'distance': 2719.869668126654, 'city': 'Calgary', 'provence': 'AB', 'bing_results': {'travel_distance': 11.464, 'travel_time': 1080.0}, 'closest': True}, {'id': '8', 'geo_cols': '910 Rue Labelle Saint-Jerome Canada', 'geo_code': (45.788776, -74.0058915), 'address': '910 Rue Labelle', 'postal_code': 'J7Z 5M5', 'fsa': 'J7Z', 'nearest_clinic_id': '', 'distance': 475.56395543076275, 'city': 'Saint-Jerome', 'provence': 'QC', 'bing_results': {'travel_distance': 557.648, 'travel_time': 21833.0}}, {'id': '9', 'geo_cols': '32 Rue De La Reserve Essipit Canada', 'geo_code': (48.3395146, -69.3966551), 'address': '32 Rue De La Reserve', 'postal_code': 'G0T 1K0', 'fsa': 'G0T', 'nearest_clinic_id': '', 'distance': 918.7932948586531, 'city': 'Essipit', 'provence': 'QC'}, {'id': '10', 'geo_cols': '1615 BOUL JACQUES-CARTIER E Longueuil Canada', 'geo_code': (43.65365176827117, -79.3942239178996), 'address': '1615 BOUL JACQUES-CARTIER E', 'postal_code': 'J4M 2X1', 'fsa': 'J4M', 'nearest_clinic_id': '', 'distance': 11.73261723162927, 'city': 'Longueuil', 'provence': 'QC', 'warning': 'did not find the geocode', 'bing_results': {'travel_distance': 16.759, 'travel_time': 1724.0}, 'closest': True}, {'id': '11', 'geo_cols': '66 Rue Sainte-Catherine E Montreal Canada', 'geo_code': (45.6442046, -73.5037492), 'address': '66 Rue Sainte-Catherine E', 'postal_code': 'H2X 1K6', 'fsa': 'H2X', 'nearest_clinic_id': '', 'distance': 503.98857239813503, 'city': 'Montreal', 'provence': 'QC'}, {'id': '12', 'geo_cols': '345 Rumsey Rd Toronto Canada', 'geo_code': (43.718796350000005, -79.37166616722675), 'address': '345 Rumsey Rd', 'postal_code': 'M4G 1R7', 'fsa': 'M4G', 'nearest_clinic_id': '', 'distance': 8.351816720090264, 'city': 'Toronto', 'provence': 'ON', 'bing_results': {'travel_distance': 12.197, 'travel_time': 1530.0}}, {'id': '13', 'geo_cols': '3713 Kensington Ave Burnaby Canada', 'geo_code': (49.2513009, -122.9674826), 'address': '3713 Kensington Ave', 'postal_code': 'V5B 0A7', 'fsa': 'V5B', 'nearest_clinic_id': '', 'distance': 3353.808672958544, 'city': 'Burnaby', 'provence': 'BC', 'bing_results': {'travel_distance': 948.214, 'travel_time': 34863.0}}, {'id': '14', 'geo_cols': '409 TACHE AVE Winnipeg Canada', 'geo_code': (49.8833047, -97.1246203), 'address': '409 TACHE AVE', 'postal_code': 'R2H 2A6', 'fsa': 'R2H', 'nearest_clinic_id': '', 'distance': 1517.666032871934, 'city': 'Winnipeg', 'provence': 'MB', 'bing_results': {'travel_distance': 1357.53, 'travel_time': 47011.0}}]







correct_format = ['patient_id', 'pat_geo_cols', 'pat_geocode', 'pat_address', 'pat_postal_code',\
                  'pat_fsa', 'nearest_clinic_id', 'clinic_geo_cols', 'clinic_geocode', 'clinic_address',\
                  'clinic_postal_code' 'clinic_fsa', 'clinic_distance']


def get_closest_info(a_patient):
    for candidate in a_patient['candidates']:
        if candidate['closest'] == True:
            return candidate
        else:
            pass


correct_format = ['patient_id', 'pat_geo_cols', 'pat_geocode', 'pat_address', 'pat_postal_code',\
                  'pat_fsa', 'nearest_clinic_id', 'clinic_geo_cols', 'clinic_geocode', 'clinic_address',\
                  'clinic_postal_code' 'clinic_fsa', 'clinic_distance']

def format_data(list_of_patients):
    final_list = []
    for patient in list_of_patients:
        formatted_data_list = []
        formatted_data_list.append(patient['id'])
        formatted_data_list.append(patient['geo_cols'])
        formatted_data_list.append(patient['geo_code'])
        formatted_data_list.append(patient['address'])
        formatted_data_list.append(patient['postal_code'])
        formatted_data_list.append(patient['fsa'])

        closest_clinic = get_closest_info(patient)

        formatted_data_list.append(closest_clinic['id'])
        formatted_data_list.append(closest_clinic['geo_cols'])
        formatted_data_list.append(closest_clinic['geo_code'])
        formatted_data_list.append(closest_clinic['address'])
        formatted_data_list.append(closest_clinic['postal_code'])
        formatted_data_list.append(closest_clinic['fsa'])
        formatted_data_list.append(closest_clinic['bing_results']['travel_distance'])

        final_list.append(formatted_data_list)

    return final_list

final_list = format_data(geocoord_patient_dict)






#utput format: The output should be a csv of the following format: Patient_ID, Pat_Geo_Cols, Pat_Geocode,
# Pat_Address, Pat_Postal_Code, Pat_FSA, Nearest_Clinic_ID, Clinic_Geo_Cols, Clinic_Geocode, Clinic_Address,
# Clinic_Postal Code, Clinic_FSA, Clinic_Distance.


# need to have a value of the columns used to find the geocode of the clinic same for the patient
#need

with open('final_patients_list2.csv', 'w', newline='') as file:
    writer = csv.writer(file)
    writer.writerows(final_list)